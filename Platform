-- LocalScript in StarterPlayerScripts
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- Make the ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "PlatformUI"
screenGui.ResetOnSpawn = false -- keeps UI after respawn
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Make the button
local button = Instance.new("TextButton")
button.Name = "WPButton"
button.Size = UDim2.new(0, 50, 0, 30) -- small size
button.Position = UDim2.new(0.5, -25, 0, 5) -- top center
button.Text = "wp"
button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
button.TextColor3 = Color3.fromRGB(255, 255, 255)
button.Parent = screenGui

-- Variables
local platform
local followConnection
local dragging = false
local dragStart, startPos

-- Function to create + follow platform
local function makeFollowPlatform()
    if platform then return end -- donâ€™t make duplicates

    local character = player.Character or player.CharacterAdded:Wait()
    local root = character:WaitForChild("HumanoidRootPart")

    platform = Instance.new("Part")
    platform.Size = Vector3.new(1000, 100, 1000) -- big thick floor
    platform.Anchored = true
    platform.CanCollide = true
    platform.Color = Color3.fromRGB(120, 200, 120)
    platform.Name = "FollowPlatform"
    platform.Parent = workspace

    followConnection = RunService.RenderStepped:Connect(function()
        if character and root then
            platform.Position = root.Position - Vector3.new(0, 10, 0) -- 10 studs below
        end
    end)
end

-- Button click: toggle platform
button.MouseButton1Click:Connect(function()
    if not platform then
        makeFollowPlatform()
        button.Text = "wp (ON)"
    else
        -- Remove platform + stop updating
        if followConnection then
            followConnection:Disconnect()
            followConnection = nil
        end
        platform:Destroy()
        platform = nil
        button.Text = "wp"
    end
end)

-- Make button draggable
button.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = button.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

button.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        if dragging then
            local delta = input.Position - dragStart
            button.Position = UDim2.new(
                startPos.X.Scale,
                startPos.X.Offset + delta.X,
                startPos.Y.Scale,
                startPos.Y.Offset + delta.Y
            )
        end
    end
end)
