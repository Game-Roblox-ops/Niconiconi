-- LocalScript inside StarterPlayerScripts

local Players = game:GetService("Players")
local player = Players.LocalPlayer
local tpHeight = 60
local platformSize = Vector3.new(6,1,6)
local platformColor = Color3.fromRGB(100,200,255)
local UserInputService = game:GetService("UserInputService")

-- ðŸ”¹ GUI Setup
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TeleportGui"
screenGui.Parent = player:WaitForChild("PlayerGui")

-- Main button (teleport + tool)
local mainButton = Instance.new("TextButton")
mainButton.Size = UDim2.new(0,200,0,50)
mainButton.Position = UDim2.new(0.5,-100,0.8,0)
mainButton.Text = "ðŸ˜‘"
mainButton.BackgroundColor3 = Color3.fromRGB(50,150,250)
mainButton.TextColor3 = Color3.new(1,1,1)
mainButton.Font = Enum.Font.SourceSansBold
mainButton.TextSize = 18
mainButton.Parent = screenGui
mainButton.Active = true
mainButton.AutoButtonColor = true

-- Collapse button
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0,50,0,50)
toggleButton.Position = UDim2.new(0.5,110,0.8,0) -- next to main button
toggleButton.Text = "â¯ˆ"
toggleButton.BackgroundColor3 = Color3.fromRGB(100,100,100)
toggleButton.TextColor3 = Color3.new(1,1,1)
toggleButton.Font = Enum.Font.SourceSansBold
toggleButton.TextSize = 24
toggleButton.Parent = screenGui
toggleButton.Active = true
toggleButton.AutoButtonColor = true

-- Toggle logic
local collapsed = false
toggleButton.MouseButton1Click:Connect(function()
	collapsed = not collapsed
	if collapsed then
		mainButton.Visible = false
		toggleButton.Text = "â¯‡"
	else
		mainButton.Visible = true
		toggleButton.Text = "â¯ˆ"
	end
end)

-- ðŸ”¹ Draggable for main button and toggle
local function makeDraggable(frame)
	local dragging, dragInput, dragStart, startPos
	local function update(input)
		local delta = input.Position - dragStart
		frame.Position = UDim2.new(
			startPos.X.Scale,
			startPos.X.Offset + delta.X,
			startPos.Y.Scale,
			startPos.Y.Offset + delta.Y
		)
	end
	frame.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 then
			dragging = true
			dragStart = input.Position
			startPos = frame.Position
			input.Changed:Connect(function()
				if input.UserInputState == Enum.UserInputState.End then
					dragging = false
				end
			end)
		end
	end)
	frame.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement then
			dragInput = input
		end
	end)
	UserInputService.InputChanged:Connect(function(input)
		if input == dragInput and dragging then
			update(input)
		end
	end)
end

makeDraggable(mainButton)
makeDraggable(toggleButton)

-- ðŸ”¹ Spawn Platform & Teleport
local function spawnPlatformAbove()
	if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then return end
	local root = player.Character.HumanoidRootPart
	local platform = Instance.new("Part")
	platform.Size = platformSize
	platform.Anchored = true
	platform.CanCollide = true
	platform.Color = platformColor
	platform.Position = root.Position + Vector3.new(0,tpHeight,0)
	platform.Name = "HighPlatform"
	platform.Parent = workspace
	root.CFrame = CFrame.new(platform.Position + Vector3.new(0,platform.Size.Y/2 + root.Size.Y/2,0))
end

-- ðŸ”¹ Equip tool by name ("CidV2")
local function equipToolByName(toolName)
	local char = player.Character
	local backpack = player:WaitForChild("Backpack")
	if not char then return nil end
	local tool = backpack:FindFirstChild(toolName)
	if tool then
		char:FindFirstChildOfClass("Humanoid"):EquipTool(tool)
		return tool
	end
	return nil
end

-- ðŸ”¹ Start continuous C/V usage
local function startContinuousCV(tool)
	if not tool then return end
	coroutine.wrap(function()
		while tool.Parent and player.Character and player.Character:FindFirstChildOfClass("Humanoid") do
			-- Replace this with actual skill functions if your tool has them
			tool:Activate() -- C
			tool:Activate() -- V
			wait(0.1) -- adjust delay if needed
		end
	end)()
end

-- ðŸ”¹ Button Click
mainButton.MouseButton1Click:Connect(function()
	spawnPlatformAbove()
	local tool = equipToolByName("CidV2")
	startContinuousCV(tool)
end)
